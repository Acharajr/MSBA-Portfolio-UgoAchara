x = "Region",
y = "Store count"
)
#4) Visualize the sales distribution by region using box plot.
ggplot(stores, aes(x = region, y = sales)) +
geom_boxplot(fill = 'grey') +
labs(
title = "Sales distribution by Region",
x = "Region",
y = "Sales"
)
data(murders)
data(heights)
data(gapminder)
head(murders)
# Basic scatter + smooth
murders |>
ggplot(aes(x = population/10^6, y = total)) +
geom_point() +
geom_smooth()
# Labels without global aes
murders |>
ggplot() +
geom_point(aes(x = population/10^6, y = total)) +
geom_text(aes(x = population/10^6, y = total, label = abb))
# Labels without global aes
murders |>
ggplot() +
geom_point(aes(x = population/10^6, y = total)) +
geom_text(aes(x = population/10^6, y = total, label = abb))
# Global aes to avoid redundancy
murders |>
ggplot(aes(population/10^6, total)) +
geom_point() +
geom_text(aes(label = abb))
# Mapping vs setting color
murders |>
ggplot(aes(population/10^6, total)) +
geom_point(aes(color = region), size = 3) +
geom_text(aes(label = abb), nudge_x = 0.1)
# Mapping vs setting color
murders |>
ggplot(aes(population/10^6, total)) +
geom_point(aes(color = region), size = 3) +
geom_text(aes(label = abb), nudge_x = 0.2)
# Mapping vs setting color
murders |>
ggplot(aes(population/10^6, total)) +
geom_point(aes(color = region), size = 3) +
geom_text(aes(label = abb), nudge_x = 0.5)
# Mapping vs setting color
murders |>
ggplot(aes(population/10^6, total)) +
geom_point(aes(color = region), size = 3) +
geom_text(aes(label = abb), nudge_x = 1)
# Mapping vs setting color
murders |>
ggplot(aes(population/10^6, total)) +
geom_point(aes(color = region), size = 3) +
geom_text(aes(label = abb), nudge_x = 1.5)
# Mapping vs setting color
murders |>
ggplot(aes(population/10^6, total)) +
geom_point(aes(color = region), size = 2) +
geom_text(aes(label = abb), nudge_x = 1.5)
murders |>
ggplot(aes(population/10^6, total)) +
geom_point(color = "blue", size = 3)
p0 <- murders |>
ggplot(aes(population/10^6, total))
p0 <- murders |>
ggplot(aes(population/10^6, total))
# Mapping vs setting color
murders |>
ggplot(aes(population/10^6, total)) +
geom_point(aes(color = region), size = 2) +
geom_text(aes(label = abb), nudge_x = 1.5)
murders |>
ggplot(aes(population/10^6, total)) +
geom_point(color = "blue", size = 3)
library(tidyverse)
library(dslabs)
library(ggrepel)
data(murders)
data(heights)
data(gapminder)
head(murders)
# Basic scatter + smooth
murders |>
ggplot(aes(x = population/10^6, y = total)) +
geom_point() +
geom_smooth()
function (package, help, pos = 2, lib.loc = NULL, character.only = FALSE,
logical.return = FALSE, warn.conflicts, quietly = FALSE,
verbose = getOption("verbose"), mask.ok, exclude, include.only,
attach.required = missing(include.only))
# Basic scatter + smooth
murders |>
ggplot(aes(x = population/10^6, y = total)) +
geom_point() +
geom_smooth()
# Labels without global aes
murders |>
ggplot() +
geom_point(aes(x = population/10^6, y = total)) +
geom_text(aes(x = population/10^6, y = total, label = abb))
# Global aes to avoid redundancy
murders |>
ggplot(aes(population/10^6, total)) +
geom_point() +
geom_text(aes(label = abb))
# Mapping vs setting color
murders |>
ggplot(aes(population/10^6, total)) +
geom_point(aes(color = region), size = 2) +
geom_text(aes(label = abb), nudge_x = 1.5)
murders |>
ggplot(aes(population/10^6, total)) +
geom_point(color = "blue", size = 3)
p0 <- murders |>
ggplot(aes(population/10^6, total))
p1 <- p0 + geom_point(aes(color = region), size = 3)
p2 <- p1 + geom_text(aes(label = abb), nudge_x = 0.1)
p3 <- p2 + scale_x_log10() + scale_y_log10()
r <- murders |>
summarize(rate = sum(total)/sum(population)*10^6) |>
pull(rate)
p0 <- murders |>
ggplot(aes(population/10^6, total))
p4 <- p3 + geom_abline(intercept = log10(r), lty = 2, color = "darkgrey")
p5 <- p4 + labs(
title = "US Gun Murders in 2010",
x = "Population in millions (log scale)",
y = "Total murders (log scale)",
color = "Region"
)
p5
# cleaned version with better labels
murders |>
ggplot(aes(population/10^6, total)) +
geom_abline(intercept = log10(r), lty = 5, color = "darkgrey") +
geom_point(aes(color = region), size = 3) +
geom_text_repel(aes(label = abb)) +
scale_x_log10() +
scale_y_log10() +
labs(
title = "US Gun Murders in 2010",
x = "Population in millions (log scale)",
y = "Total murders (log scale)",
color = "Region"
)
head(heights)
# Density
heights |>
filter(sex == "Female") |>
ggplot(aes(height))
# Density
heights |>
filter(sex == "Female") |>
ggplot(aes(height)) +
geom_density(fill = "blue", alpha = 0.4)
# Histogram
heights |>
filter(sex == "Female") |>
ggplot(aes(height)) +
geom_histogram(binwidth = 1, fill = "blue", col = "black")
# Density
heights |>
filter(sex == "Female") |>
ggplot(aes(height)) +
geom_density(fill = "blue", alpha = 0.4)
# Histogram
heights |>
filter(sex == "Female") |>
ggplot(aes(height)) +
geom_histogram( fill = "blue", col = "black")
# Histogram
heights |>
filter(sex == "Female") |>
ggplot(aes(height)) +
geom_histogram(binwidth = 1, fill = "blue", col = "black")
# Boxplot by gender
heights |>
ggplot(aes(sex, height)) +
geom_boxplot()
# Density
heights |>
ggplot(aes(height)) +
geom_density(fill = "blue", alpha = 0.4)
murders |>
ggplot(aes(y = region)) +
geom_bar()
murders |>
ggplot(aes(y = region)) +
geom_bar(fill = region)
murders |>
ggplot(aes(y = region)) +
geom_bar(color = region)
murders |>
ggplot(aes(y = region)) +
geom_bar(color = "red")
murders |>
ggplot(aes(y = region, color = "red")) +
geom_bar(color = "black")
tab <- murders |>
count(region) |>
mutate(proportion = n/sum(n))
tab |>
ggplot(aes(region, proportion)) +
geom_col()
head(gapminder)
# Single year scatter
gapminder |>
filter(year == 1962) |>
ggplot(aes(fertility, life_expectancy, color = continent)) +
geom_point()
# Facet by year
gapminder |>
filter(year %in% c(1962, 1992, 2012)) |>
ggplot(aes(fertility, life_expectancy, color = continent)) +
geom_point() +
facet_grid(. ~ year)
# Facet by year
gapminder |>
filter(year %in% c(1962, 1992, 2012)) |>
ggplot(aes(fertility, life_expectancy, color = continent)) +
geom_point()
# Facet by year
gapminder |>
filter(year %in% c(1962, 1992, 2012)) |>
ggplot(aes(fertility, life_expectancy, color = continent)) +
geom_point() +
facet_grid(. ~ year)
# Facet by year
gapminder |>
filter(year %in% c(1962, 1992, 2012)) |>
ggplot(aes(fertility, life_expectancy, color = continent)) +
geom_point() +
facet_grid(year ~ continent)
# Facet by year
gapminder |>
filter(year %in% c(1962, 1992, 2012)) |>
ggplot(aes(fertility, life_expectancy, color = continent)) +
geom_point() +
facet_grid(. ~ year)
# Time series for one country
gapminder |>
filter(country == "United States") |>
ggplot(aes(year, fertility)) +
geom_line()
# Time series for two countries (fertility)
countries <- c("South Korea", "Germany")
gapminder |>
filter(country %in% countries, !is.na(fertility)) |>
ggplot(aes(year, fertility, color = country)) +
geom_line()
# Time series for two countries (life expectancy)
countries <- c("Brazil", "Japan")
gapminder |>
filter(country %in% countries, !is.na(life_expectancy)) |>
ggplot(aes(year, life_expectancy, color = country)) +
geom_line()
# Histogram
heights |>
filter(sex == "Female") |>
ggplot(aes(height)) +
geom_histogram(binwidth = 1, fill = "blue", col = "black")
library(tidyverse)
library(dslabs)
library(ggrepel)
# Histogram
heights |>
filter(sex == "Female") |>
ggplot(aes(height)) +
geom_histogram(binwidth = 1, fill = "blue", col = "black")
# Density
heights |>
filter(sex == "Female") |>
ggplot(aes(height)) +
geom_density(fill = "blue", alpha = 0.4)
x <- c(20090101, "2009-01-02", "2009 01 03", "2009-1-4")
ymd(x)
str_trim("  Hello World!  ")
p4 <- p3 + geom_abline(intercept = log10(r), lty = 2, color = "darkgrey")
p0 <- murders |>
ggplot(aes(population/10^6, total))
p1 <- p0 + geom_point(aes(color = region), size = 3)
p2 <- p1 + geom_text(aes(label = abb), nudge_x = 0.1)
p3 <- p2 + scale_x_log10() + scale_y_log10()
r <- murders |>
summarize(rate = sum(total)/sum(population)*10^6) |>
pull(rate)
p4 <- p3 + geom_abline(intercept = log10(r), lty = 2, color = "darkgrey")
p5 <- p4 + labs(
title = "US Gun Murders in 2010",
x = "Population in millions (log scale)",
y = "Total murders (log scale)",
color = "Region"
)
p5
sum(2,3) |> sum(20) |> sqrt() - 25|>sqrt()
#2) Check for missing values and duplicate rows. Comment briefly on whether the dataset looks clean or needs attention. [2 point]
#cheack for missing values
print(colSums(is.na(sales)))
library(tidyverse)  # dplyr + ggplot2 + readr
library(lubridate)  # dates
getwd()
setwd("~/Library/CloudStorage/OneDrive-NorthwesternUniversity/Grad School/UofL Grad/MSBA 615/Session Five/")
sales <- read_csv("sales_data_sample.csv", show_col_types = FALSE)
#1) Get an overview of the sales dataset (number of rows, columns, types of the columns) and print the 1st 6 rows. [1 point]
glimpse(sales)
head(sales)
#2) Check for missing values and duplicate rows. Comment briefly on whether the dataset looks clean or needs attention. [2 point]
#cheack for missing values
print(colSums(is.na(sales)))
#4) Create a new variable that measures revenue per unit (SALES divided by quantity ordered). This should be reflected in the original sales dataset. [2 points]
sales <- sales |> mutate(REVENUE_PER_UNIT = SALES/QUANTITYORDERED)
#5) Using sales amount, create three order categories: High, Medium, and Low (SALES > 4000 ~ "High", SALES > 2000 ~ "Medium"). Create a new group summary which tells total sales for each category. Then use a bar plot to present your findings. [3 points]
sales <- sales |>
mutate(sales_category = case_when(
SALES > 4000 ~ "High",
SALES > 2000 ~ "Medium",
TRUE ~ "Low"
))
View(sales)
View(sales)
group_summary <- sales |>
group_by(sales_category) |>
summarise(TotalSales = sum(SALES))
View(group_summary)
View(group_summary)
ggplot(aes(x = sales_category, y = TotalSales)) +
geom_bar(stat = "identity") +
labs(title = "Total Sales by Order Category",
x = "Order Category",
y = "Total Sales") +
theme_minimal()
ggplot(aes(x = sales_category, y = TotalSales)) +
geom_bar(stat = "identity") +
labs(title = "Total Sales by Order Category",
x = "Order Category",
y = "Total Sales")
sales |> ggplot(aes(x = sales_category, y = TotalSales)) +
geom_bar(stat = "identity") +
labs(title = "Total Sales by Order Category",
x = "Order Category",
y = "Total Sales")
View(group_summary)
group_summary |> ggplot(aes(x = sales_category, y = TotalSales)) +
geom_bar(stat = "identity") +
labs(title = "Total Sales by Order Category",
x = "Order Category",
y = "Total Sales")
group_summary |> ggplot(aes(x = sales_category, y = TotalSales)) +
geom_bar(color "tomato") +
group_summary |> ggplot(aes(x = sales_category, y = TotalSales)) +
geom_bar(color = "tomato") +
labs(title = "Total Sales by Order Category",
x = "Order Category",
y = "Total Sales")
group_summary |> ggplot(aes(x = sales_category, y = TotalSales)) +
geom_bar(color = "tomato", stat = "identity") +
labs(title = "Total Sales by Order Category",
x = "Order Category",
y = "Total Sales")
group_summary |> ggplot(aes(y = sales_category, x = TotalSales)) +
geom_bar(color = "tomato", stat = "identity") +
labs(title = "Total Sales by Order Category",
x = "Order Category",
y = "Total Sales")
group_summary |> ggplot(aes(x = sales_category, y = TotalSales)) +
geom_bar(color = "tomato", stat = "identity") +
labs(title = "Total Sales by Order Category",
x = "Order Category",
y = "Total Sales")
group_summary |> ggplot(aes(x = sales_category, y = TotalSales)) +
geom_bar(color = "tomato", stat = "identity", fill = "purple") +
labs(title = "Total Sales by Order Category",
x = "Order Category",
y = "Total Sales")
head(sales)
View(sales)
#6) Compute total sales for each product line and store it in a new dataframe. Comment, Which product line has the highest total sales? Visualize it with an appropriate bar plot. [3 points]
Total_sales_per_product_line <- sales |>
select(PRODUCTLINE) |>
#7) Compute total sales by country and store it in a new dataframe. Comment the top three countries by sales. Use a bar plot to show your findings. [3 points]
#8) Calculate total sales for each month across all years (Hint: group with month id and year id). Visualize the trend with appropriate plot type. Comment which months show consistently higher sales across different years? [4 points]
sales_by_month_year <- sales |>
group_by(YearID, MonthID) |>
summarise(TotalSales = sum(SALES, na.rm = TRUE)) |>
arrange(YearID, MonthID)
#6) Compute total sales for each product line and store it in a new dataframe. Comment, Which product line has the highest total sales? Visualize it with an appropriate bar plot. [3 points]
Total_sales_per_product_line <- sales |>
select(PRODUCTLINE) |>
#7) Compute total sales by country and store it in a new dataframe. Comment the top three countries by sales. Use a bar plot to show your findings. [3 points]
#8) Calculate total sales for each month across all years (Hint: group with month id and year id). Visualize the trend with appropriate plot type. Comment which months show consistently higher sales across different years? [4 points]
sales_by_month_year <- sales |>
group_by(YearID, MonthID) |>
summarise(TotalSales = sum(SALES, na.rm = TRUE)) |>
arrange(YearID, MonthID)
#6) Compute total sales for each product line and store it in a new dataframe. Comment, Which product line has the highest total sales? Visualize it with an appropriate bar plot. [3 points]
Total_sales_per_product_line <- sales |>
select(PRODUCTLINE) |>
#7) Compute total sales by country and store it in a new dataframe. Comment the top three countries by sales. Use a bar plot to show your findings. [3 points]
#8) Calculate total sales for each month across all years (Hint: group with month id and year id). Visualize the trend with appropriate plot type. Comment which months show consistently higher sales across different years? [4 points]
sales_by_month_year <- sales |>
group_by(Year_ID, Month_ID) |>
summarise(TotalSales = sum(SALES, na.rm = TRUE)) |>
arrange(Year_ID, Month_ID)
head(sales)
#6) Compute total sales for each product line and store it in a new dataframe. Comment, Which product line has the highest total sales? Visualize it with an appropriate bar plot. [3 points]
Total_sales_per_product_line <- sales |>
select(PRODUCTLINE) |>
#7) Compute total sales by country and store it in a new dataframe. Comment the top three countries by sales. Use a bar plot to show your findings. [3 points]
#8) Calculate total sales for each month across all years (Hint: group with month id and year id). Visualize the trend with appropriate plot type. Comment which months show consistently higher sales across different years? [4 points]
sales_by_month_year <- sales |>
group_by(YEAR_ID, MONTH_ID) |>
summarise(TotalSales = sum(SALES, na.rm = TRUE)) |>
arrange(YEAR_ID, MONTH_ID)
#6) Compute total sales for each product line and store it in a new dataframe. Comment, Which product line has the highest total sales? Visualize it with an appropriate bar plot. [3 points]
Total_sales_per_product_line <- sales |>
select(PRODUCTLINE) |>
#7) Compute total sales by country and store it in a new dataframe. Comment the top three countries by sales. Use a bar plot to show your findings. [3 points]
#8) Calculate total sales for each month across all years (Hint: group with month id and year id). Visualize the trend with appropriate plot type. Comment which months show consistently higher sales across different years? [4 points]
sales_by_month_year <- sales |>
group_by(YEAR_ID, MONTH_ID) |>
summarise(TotalSales = sum(SALES, na.rm = TRUE)) |>
arrange(YEAR_ID, MONTH_ID)
#6) Compute total sales for each product line and store it in a new dataframe. Comment, Which product line has the highest total sales? Visualize it with an appropriate bar plot. [3 points]
Total_sales_per_product_line <- sales |>
select(PRODUCTLINE) |>
#7) Compute total sales by country and store it in a new dataframe. Comment the top three countries by sales. Use a bar plot to show your findings. [3 points]
#8) Calculate total sales for each month across all years (Hint: group with month id and year id). Visualize the trend with appropriate plot type. Comment which months show consistently higher sales across different years? [4 points]
sales_by_month_year <- sales |>
group_by(YEAR_ID, MONTH_ID) |>
summarise(TotalSales = sum(SALES)) |>
arrange(YEAR_ID, MONTH_ID)
#6) Compute total sales for each product line and store it in a new dataframe. Comment, Which product line has the highest total sales? Visualize it with an appropriate bar plot. [3 points]
Total_sales_per_product_line <- sales |>
select(PRODUCTLINE) |>
#7) Compute total sales by country and store it in a new dataframe. Comment the top three countries by sales. Use a bar plot to show your findings. [3 points]
#8) Calculate total sales for each month across all years (Hint: group with month id and year id). Visualize the trend with appropriate plot type. Comment which months show consistently higher sales across different years? [4 points]
sales_by_MY <- sales |>
group_by(MONTH_ID) |>
summarise(TotalSales = sum(SALES)) |>
arrange(MONTH_ID)
#6) Compute total sales for each product line and store it in a new dataframe. Comment, Which product line has the highest total sales? Visualize it with an appropriate bar plot. [3 points]
Total_sales_per_product_line <- sales |>
select(PRODUCTLINE) |>
#7) Compute total sales by country and store it in a new dataframe. Comment the top three countries by sales. Use a bar plot to show your findings. [3 points]
#8) Calculate total sales for each month across all years (Hint: group with month id and year id). Visualize the trend with appropriate plot type. Comment which months show consistently higher sales across different years? [4 points]
sales_by_MY <- sales |>
group_by (YEAR_ID, MONTH_ID) |>
summarise(TotalSales = sum(SALES)) |>
arrange(YEAR_ID, MONTH_ID)
#6) Compute total sales for each product line and store it in a new dataframe. Comment, Which product line has the highest total sales? Visualize it with an appropriate bar plot. [3 points]
Total_sales_per_product_line <- sales |>
select(PRODUCTLINE) |>
#7) Compute total sales by country and store it in a new dataframe. Comment the top three countries by sales. Use a bar plot to show your findings. [3 points]
#8) Calculate total sales for each month across all years (Hint: group with month id and year id). Visualize the trend with appropriate plot type. Comment which months show consistently higher sales across different years? [4 points]
sales_by_country <- sales |>
group_by(MONTH_ID, YEAR_ID) |>
summarise(TotalSales = sum(SALES, na.rm = TRUE))
sales_by_country <- sales %>%
group_by(MONTH_ID, YEAR_ID) %>%
summarise(TotalSales = sum(SALES, na.rm = TRUE))
View(sales_by_country)
library(tidyverse)  # dplyr + ggplot2 + readr
library(lubridate)  # dates
getwd()
setwd("~/Library/CloudStorage/OneDrive-NorthwesternUniversity/Grad School/UofL Grad/MSBA 615/Session Five/")
sales <- read_csv("sales_data_sample.csv", show_col_types = FALSE)
#1) Get an overview of the sales dataset (number of rows, columns, types of the columns) and print the 1st 6 rows. [1 point]
glimpse(sales)
head(sales)
#2) Check for missing values and duplicate rows. Comment briefly on whether the dataset looks clean or needs attention. [2 point]
#cheack for missing values
print(colSums(is.na(sales)))
# Check for duplicates.
print(sum(duplicated(sales)))
#3) Create a new separate dataset to keep only orders from USA belonging to Classic Cars, and select only the most relevant columns like   ORDERNUMBER, PRODUCTLINE, COUNTRY, SALES. Print the 1st 6 rows of this dataset. [2 points]
USA_orders <- sales |>
select(ORDERNUMBER, PRODUCTLINE, COUNTRY, SALES) |>
filter(PRODUCTLINE == "Classic Cars",COUNTRY == "USA")
head(USA_orders)
#4) Create a new variable that measures revenue per unit (SALES divided by quantity ordered). This should be reflected in the original sales dataset. [2 points]
sales <- sales |> mutate(REVENUE_PER_UNIT = SALES/QUANTITYORDERED)
head(sales)
#5) Using sales amount, create three order categories: High, Medium, and Low (SALES > 4000 ~ "High", SALES > 2000 ~ "Medium"). Create a new group summary which tells total sales for each category. Then use a bar plot to present your findings. [3 points]
sales <- sales |>
mutate(sales_category = case_when(
SALES > 4000 ~ "High",
SALES > 2000 ~ "Medium",
TRUE ~ "Low"
))
group_summary <- sales |>
group_by(sales_category) |>
summarise(TotalSales = sum(SALES))
group_summary |> ggplot(aes(x = sales_category, y = TotalSales)) +
geom_bar(color = "tomato", stat = "identity", fill = "purple") +
labs(title = "Total Sales by Order Category",
x = "Sales Category",
y = "Total Sales")
head(sales)
#6) Compute total sales for each product line and store it in a new dataframe. Comment, Which product line has the highest total sales? Visualize it with an appropriate bar plot. [3 points]
Total_sales_per_product_line <- sales |>
select(PRODUCTLINE) |>
#7) Compute total sales by country and store it in a new dataframe. Comment the top three countries by sales. Use a bar plot to show your findings. [3 points]
#8) Calculate total sales for each month across all years (Hint: group with month id and year id). Visualize the trend with appropriate plot type. Comment which months show consistently higher sales across different years? [4 points]
sales_by_MY <- sales %>%
group_by(MONTH_ID, YEAR_ID) %>%
summarise(TotalSales = sum(SALES, na.rm = TRUE))

churn = ifelse(left_flag_clean == "Yes", 1, 0)
)
cat_vars <- c("add_on_security", "e_bill_opt_in", "add_on_backup",
"add_on_protection", "stream_movies", "stream_tv")  # <-- your 5 categorical variables
df_long <- df |>
pivot_longer(cols = all_of(cat_vars),
names_to = "variable",
values_to = "category")
churn_rates <- df_long |>
group_by(variable, category) |>
summarise(churn_rate = mean(churn, na.rm = TRUE))
View(churn_rates)
View(churn_rates)
table(df$left_flag, df$churn)
df <- retentiondata_case |>
mutate(
left_flag_clean = trimws(tolower(left_flag)),
churn = ifelse(left_flag_clean == "yes", 1, 0)
)
df <- retentiondata_case |>
mutate(
left_flag_clean = trimws(tolower(left_flag)),
churn = ifelse(left_flag_clean == "Yes", 1, 0)
)
table(df$left_flag, df$churn)
View(churn_rates)
View(churn_rates)
library(dplyr)
library(tidyr)
library(ggplot2)
df <- retentiondata_case |>
mutate(
left_flag_clean = trimws(tolower(left_flag)),
churn = ifelse(left_flag_clean == "yes", 1, 0)
)
View(df)
cat_vars <- c("add_on_security", "e_bill_opt_in", "add_on_backup",
"add_on_protection", "stream_movies", "stream_tv")   # <-- your 5 categorical variables
df_long <- df |>
pivot_longer(cols = all_of(cat_vars),
names_to = "variable",
values_to = "category")
View(df_long)
churn_rates <- df_long |>
group_by(variable, category) |>
summarise(churn_rate = mean(churn, na.rm = TRUE))
View(churn_rates)
ggplot(churn_rates, aes(x = category, y = churn_rate, fill = category)) +
geom_col() +
scale_y_continuous(labels = scales::percent_format()) +
facet_wrap(~ variable, scales = "free_x") +
labs(
title = "Churn Rate Across Multiple Categorical Variables",
x = "Category",
y = "Churn Rate (%)"
) +
theme_minimal() +
theme(legend.position = "none")
#churn by recent offer
df |>
group_by(recent_offer) |>
summarise(churn_rate = mean(churn, na.rm = TRUE)) |>
ggplot(aes(x = recent_offer, y = churn_rate, fill = recent_offer)) +
geom_col() + scale_y_continuous(labels = scales::percent_format()) +
labs( title = "Churn Rate by Recent Offer", x = "Recent Offer", y = "Churn Rate (%)" ) +
theme_minimal() +
theme(legend.position = "none")
#Trend
ggplot(retentiondata_case, aes(x = avg_gb_download)) +
geom_histogram(binwidth = 5, fill = "steelblue", color = "white") +
labs(
title = "Distribution of Average GB Downloaded",
x = "Average GB Downloaded",
y = "Count of Customers"
) +
theme_minimal()
#Trend
ggplot(retentiondata_case, aes(x = extra_data_fees_total)) +
geom_histogram(binwidth = 5, fill = "steelblue", color = "white") +
labs(
title = "Distribution of Average GB Downloaded",
x = "Average GB Downloaded",
y = "Count of Customers"
) +
theme_minimal()
#Trend
ggplot(retentiondata_case, aes(x = referrals_count)) +
geom_histogram(binwidth = 5, fill = "steelblue", color = "white") +
labs(
title = "Distribution of Average GB Downloaded",
x = "Average GB Downloaded",
y = "Count of Customers"
) +
theme_minimal()
#Trend
ggplot(retentiondata_case, aes(x = monthly_fee)) +
geom_histogram(binwidth = 5, fill = "steelblue", color = "white") +
labs(
title = "Distribution of Average GB Downloaded",
x = "Average GB Downloaded",
y = "Count of Customers"
) +
theme_minimal()
#Trend
ggplot(retentiondata_case, aes(x = monthly_fee)) +
geom_histogram(binwidth = 1, fill = "steelblue", color = "white") +
labs(
title = "Distribution of Average GB Downloaded",
x = "Average GB Downloaded",
y = "Count of Customers"
) +
theme_minimal()
#Trend
ggplot(retentiondata_case, aes(x = monthly_fee)) +
geom_histogram(fill = "steelblue", color = "white") +
labs(
title = "Distribution of Average GB Downloaded",
x = "Average GB Downloaded",
y = "Count of Customers"
) +
theme_minimal()
ggplot(retentiondata_case, aes(x = monthly_fee)) +
geom_histogram(aes(y = ..density..), binwidth = 5, fill = "skyblue", color = "white", alpha = 0.7) +
geom_density(color = "red", size = 1.2) +
labs(
title = "Trend and Distribution of Monthly Fee",
x = "Monthly Fee",
y = "Density"
) +
theme_minimal()
retentiondata_case |>
mutate(
left_flag_clean = trimws(tolower(left_flag)),
churn = ifelse(left_flag_clean == "Yes", 1, 0)
) |>
group_by(churn) |>
summarise(avg_monthly_fee = mean(monthly_fee, na.rm = TRUE))
retentiondata_case |>
mutate(
left_flag_clean = trimws(tolower(left_flag)),
churn = ifelse(left_flag_clean == "yes", 1, 0)
) |>
group_by(churn) |>
summarise(avg_monthly_fee = mean(monthly_fee, na.rm = TRUE))
cat_vars <- c("add_on_security", "add_on_backup",
"add_on_protection", "stream_movies", "stream_tv")
df_long <- df |>
pivot_longer(cols = all_of(cat_vars),
names_to = "variable",
values_to = "category")
churn_rates <- df_long |>
group_by(variable, category) |>
summarise(churn_rate = mean(churn, na.rm = TRUE))
ggplot(churn_rates, aes(x = category, y = churn_rate, fill = category)) +
geom_col() +
scale_y_continuous(labels = scales::percent_format()) +
facet_wrap(~ variable, scales = "free_x") +
labs(
title = "Churn Rate Across Multiple Categorical Variables",
x = "Category",
y = "Churn Rate (%)"
) +
theme_minimal() +
theme(legend.position = "none")
cat_vars <- c("add_on_security", "add_on_backup",
"add_on_protection")
df_long <- df |>
pivot_longer(cols = all_of(cat_vars),
names_to = "variable",
values_to = "category")
churn_rates <- df_long |>
group_by(variable, category) |>
summarise(churn_rate = mean(churn, na.rm = TRUE))
ggplot(churn_rates, aes(x = category, y = churn_rate, fill = category)) +
geom_col() +
scale_y_continuous(labels = scales::percent_format()) +
facet_wrap(~ variable, scales = "free_x") +
labs(
title = "Churn Rate Across Multiple Categorical Variables",
x = "Category",
y = "Churn Rate (%)"
) +
theme_minimal() +
theme(legend.position = "none")
library(readxl)
sasExport071R <- read_excel("OneDrive - Northwestern University/Grad School/UofL Grad/Spring semester/MSBA 625/Week 3/sasExport071R.xlsx")
View(sasExport071R)
library(dplyr)
library(ggplot2)
student_data %>%
filter(`International Student Status` == "Yes") %>%   # keep only international students
count(`Program Description`) %>%                      # count enrollment by program
ggplot(aes(x = reorder(`Program Description`, n), y = n)) +
geom_col(fill = "#2C7FB8") +
coord_flip() +
labs(
title = "International Student Enrollment by Program",
x = "Program",
y = "Number of International Students"
) +
theme_minimal(base_size = 13)
sasExport071R %>%
filter(`International Student Status` == "Yes") %>%   # keep only international students
count(`Program Description`) %>%                      # count enrollment by program
ggplot(aes(x = reorder(`Program Description`, n), y = n)) +
geom_col(fill = "#2C7FB8") +
coord_flip() +
labs(
title = "International Student Enrollment by Program",
x = "Program",
y = "Number of International Students"
) +
theme_minimal(base_size = 13)
unique(sasExport071R$`International Student Status`)
sasExport071R %>%
filter(`International Student Status` == "International Student: Yes") %>%
count(`Program Description`) %>%
ggplot(aes(x = reorder(`Program Description`, n), y = n)) +
geom_col(fill = "#2C7FB8") +
coord_flip() +
labs(
title = "International Student Enrollment by Program",
x = "Program",
y = "Number of International Students"
) +
theme_minimal(base_size = 13)
sasExport071R %>%
filter(`International Student Status` == "International Student: Yes") %>%
count(`Program Description`) %>%
ggplot(aes(x = reorder(`Program Description`, n), y = n)) +
geom_col(fill = "#2C7FB8") +
coord_flip() +
labs(
title = "International Student Enrollment by Program",
x = "Program",
y = "Number of International Students"
)
sasExport071R %>%
mutate(
intl_flag = str_detect(`International Student Status`, "Yes")  # TRUE for international
) %>%
group_by(`Program Description`) %>%
summarise(
pct_international = mean(intl_flag, na.rm = TRUE) * 100
) %>%
arrange(desc(pct_international)) %>%
ggplot(aes(x = reorder(`Program Description`, pct_international),
y = pct_international)) +
geom_col(fill = "#2C7FB8") +
coord_flip() +
labs(
title = "Percentage of International Students by Program",
x = "Program",
y = "Percent International"
) +
theme_minimal(base_size = 13)
library(dplyr)
library(ggplot2)
library(stringr)
sasExport071R %>%
mutate(
intl_flag = str_detect(`International Student Status`, "Yes")  # TRUE for international
) %>%
group_by(`Program Description`) %>%
summarise(
pct_international = mean(intl_flag, na.rm = TRUE) * 100
) %>%
arrange(desc(pct_international)) %>%
ggplot(aes(x = reorder(`Program Description`, pct_international),
y = pct_international)) +
geom_col(fill = "#2C7FB8") +
coord_flip() +
labs(
title = "Percentage of International Students by Program",
x = "Program",
y = "Percent International"
) +
theme_minimal(base_size = 13)
sasExport071R %>%
mutate(intl_flag = str_detect(`International Student Status`, "Yes")) %>%
group_by(`Program Description`) %>%
summarise(pct_international = mean(intl_flag) * 100) %>%
arrange(desc(pct_international)) %>%
slice_head(n = 15) %>%   # <-- show top 15 programs
ggplot(aes(x = reorder(`Program Description`, pct_international),
y = pct_international)) +
geom_col(fill = "#2C7FB8") +
coord_flip() +
labs(
title = "Top 15 Programs by Percentage of International Students",
x = "Program",
y = "Percent International"
) +
theme_minimal(base_size = 13)
sasExport071R %>%
mutate(intl_flag = str_detect(`International Student Status`, "Yes")) %>%
group_by(`Department`) %>%   # or Program Type
summarise(pct_international = mean(intl_flag) * 100) %>%
arrange(desc(pct_international)) %>%
ggplot(aes(x = reorder(Department, pct_international),
y = pct_international)) +
geom_col(fill = "#2C7FB8") +
coord_flip() +
labs(
title = "Percentage of International Students by Department",
x = "Department",
y = "Percent International"
) +
theme_minimal(base_size = 13)
sasExport071R %>%
mutate(intl_flag = str_detect(`International Student Status`, "Yes")) %>%
group_by(Semester) %>%
summarise(
total_students = n(),
intl_students = sum(intl_flag),
pct_international = (intl_students / total_students) * 100
) %>%
ggplot(aes(x = Semester, y = pct_international, group = 1)) +
geom_line(size = 1.2, color = "#2C7FB8") +
geom_point(size = 3, color = "#2C7FB8") +
labs(
title = "International Student Enrollment Over Time",
x = "Semester",
y = "Percent International"
) +
theme_minimal(base_size = 14) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
sasExport071R %>%
filter(str_detect(`International Student Status`, "Yes")) %>%   # keep only international students
count(Semester) %>%                                             # count per semester
ggplot(aes(x = Semester, y = n, group = 1)) +
geom_line(size = 1.2, color = "#2C7FB8") +
geom_point(size = 3, color = "#2C7FB8") +
labs(
title = "International Student Enrollment by Semester",
x = "Semester",
y = "International Student Count"
) +
theme_minimal(base_size = 14) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(dplyr)
library(ggplot2)
library(stringr)
library(forcats)
sasExport071R %>%
# Flag international students
filter(str_detect(`International Student Status`, "Yes")) %>%
# Create a combined semester label like "Fall 2019"
mutate(
semester_label = paste(Semester, `Academic Year`)
) %>%
# Count international students per semester
count(semester_label) %>%
# Ensure semesters appear in chronological order
mutate(semester_label = fct_inorder(semester_label)) %>%
ggplot(aes(x = semester_label, y = n, group = 1)) +
geom_line(size = 1.2, color = "#2C7FB8") +
geom_point(size = 3, color = "#2C7FB8") +
labs(
title = "International Student Enrollment by Semester",
x = "Semester",
y = "International Student Count"
) +
theme_minimal(base_size = 14) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
sasExport071R %>%
# Keep only international students
filter(str_detect(`International Student Status`, "Yes")) %>%
# Create a clean semester label like "Fall 2019"
mutate(
semester_label = paste(Semester, `Academic Year`),
# Extract year (assumes Academic Year is like "2019-2020")
year_start = as.numeric(str_sub(`Academic Year`, 1, 4)),
# Assign numeric order to semesters
sem_order = case_when(
str_detect(Semester, regex("Spring", ignore_case = TRUE)) ~ 1,
str_detect(Semester, regex("Summer", ignore_case = TRUE)) ~ 2,
str_detect(Semester, regex("Fall",   ignore_case = TRUE)) ~ 3,
TRUE ~ 4
),
# Build a sortable key
sort_key = year_start * 10 + sem_order
) %>%
# Count international students per semester
count(semester_label, sort_key) %>%
# Order by the chronological key
arrange(sort_key) %>%
mutate(semester_label = factor(semester_label, levels = semester_label)) %>%
ggplot(aes(x = semester_label, y = n, group = 1)) +
geom_line(size = 1.2, color = "#2C7FB8") +
geom_point(size = 3, color = "#2C7FB8") +
labs(
title = "International Student Enrollment by Semester",
x = "Semester",
y = "International Student Count"
) +
theme_minimal(base_size = 14) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(readxl)
BEA_Auto_Light_Truck_Sales_CLEAN <- read_excel("BEA Auto-Light Truck Sales CLEAN.xlsx")
View(BEA_Auto_Light_Truck_Sales_CLEAN)
View(BEA_Auto_Light_Truck_Sales_CLEAN)
View(BEA_Auto_Light_Truck_Sales_CLEAN)
library(readxl)
library(purrr)
# Path to your Excel file
file_path <- "BEA Auto-Light Truck Sales.xlsx"
# Get all sheet names
sheet_names <- excel_sheets(file_path)
getwd()
getwd()
setwd("~/Library/CloudStorage/OneDrive-NorthwesternUniversity/Grad School/UofL Grad/Spring semester/MSBA 625/Week 1")
# Path to your Excel file
file_path <- "BEA Auto-Light Truck Sales.xlsx"
# Get all sheet names
sheet_names <- excel_sheets(file_path)
# Read each sheet into a named list of data frames
df_list <- map(sheet_names, ~ read_excel(file_path, sheet = .x)) %>%
set_names(sheet_names)
# Optional: assign each sheet to its own data frame in the environment
list2env(df_list, envir = .GlobalEnv)
View(`Auto Sales (1990-2016)`)
View(BEA_Auto_Light_Truck_Sales_CLEAN)
View(df_list)
View(`Light Truck Sales (1990-2016)`)
View(Readme)
View(Readme)
View(Readme)
View(Readme)
View(`Auto Sales (1990-2016)`)
# Path to your Excel file
file_path <- "BEA Auto-Light Truck Sales.xlsx"
# Get all sheet names
sheet_names <- excel_sheets(file_path)
# Read each sheet into a named list of data frames
df_list <- map(sheet_names, ~ read_excel(file_path, sheet = .x)) %>%
set_names(sheet_names)
View(df_list)
# Optional: assign each sheet to its own data frame in the environment
list2env(df_list, envir = .GlobalEnv)
View(`Auto Sales (1990-2016)`)
View(`Light Truck Sales (1990-2016)`)
View(`Light Truck Sales (1990-2016)`)
# Load required library
library(readxl)
library(dplyr)
# File path (update if needed)
file_path <- "BEA Auto-Light Truck Sales.xlsx"
# Read second and third sheets
auto_sales <- read_excel(file_path, sheet = 2)
light_truck_sales <- read_excel(file_path, sheet = 3)
# Add source identifiers
auto_sales <- auto_sales %>% mutate(source = "Auto Sales (1990-2016)")
View(auto_sales)
View(auto_sales)
library(readr)
auto_sales <- read_csv("auto_sales.csv")
View(auto_sales)
library(readr)
light_trucks <- read_csv("light_trucks.csv")
View(light_trucks)
library(dplyr)
library(ggplot2)
# Filter dataset for 2008–2016
auto_2008_2016 <- auto_sales %>%
filter(year >= 2008, year <= 2016)
# Filter dataset for 2008–2016
auto_2008_2016 <- auto_sales %>%
filter(Year >= 2008, year <= 2016)
# Filter dataset for 2008–2016
auto_2008_2016 <- auto_sales %>%
filter(Year >= 2008, Year <= 2016)
# Line chart of automobile sales
ggplot(auto_2008_2016, aes(x = year, y = automobile_sales)) +
geom_line(color = "steelblue", size = 1.2) +
geom_point(color = "darkred", size = 3) +
labs(
title = "U.S. Automobile Sales (2008–2016)",
x = "Year",
y = "Automobile Sales (Units)"
) +
theme_minimal(base_size = 14)
# Line chart of automobile sales
ggplot(auto_2008_2016, aes(x = Year, y = `Not seasonally adjusted (Thousands)...3`)) +
geom_line(color = "steelblue", size = 1.2) +
geom_point(color = "darkred", size = 3) +
labs(
title = "U.S. Automobile Sales (2008–2016)",
x = "Year",
y = "Automobile Sales (Units)"
) +
theme_minimal(base_size = 14)
# Line chart of automobile sales
ggplot(auto_2008_2016, aes(x = Year, y = `Not seasonally adjusted (Thousands)...3`)) +
geom_line(color = "steelblue", size = 1.2) +
geom_histogram(color = "darkred", size = 3) +
labs(
title = "U.S. Automobile Sales (2008–2016)",
x = "Year",
y = "Automobile Sales (Units)"
) +
theme_minimal(base_size = 14)
# Line chart of automobile sales
ggplot(auto_2008_2016, aes( y = `Not seasonally adjusted (Thousands)...3`)) +
geom_line(color = "steelblue", size = 1.2) +
geom_histogram(color = "darkred", size = 3) +
labs(
title = "U.S. Automobile Sales (2008–2016)",
x = "Year",
y = "Automobile Sales (Units)"
) +
theme_minimal(base_size = 14)
